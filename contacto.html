{% extends 'base.html' %}

{% block head %}
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css">
    <style>
        .form-container {
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        .btn-success {
            background-color: #28a745; /* Verde estándar */
            border-color: #28a745;
        }
        .btn-success:hover {
            background-color: #218838; /* Verde oscuro */
            border-color: #1e7e34;
        }
        .btn-accessibility {
            position: fixed;
            bottom: 120px; /* Arriba del botón de WhatsApp */
            right: 20px;
            z-index: 1000;
        }
        .btn-whatsapp {
            position: fixed;
            bottom: 40px; /* Botón de WhatsApp */
            right: 20px;
            z-index: 999;
        }
        .form-container button[type="submit"] {
            margin-bottom: 40px; /* Separación del footer */
        }
        
        /* Fondo verde solo para el contenedor específico */
        .custom-background {
            background-color: #52928f !important; /* Color de fondo verde */
        }

        /* Estilos opcionales para el body */
        body {
            background-color: #eafcf7 !important; /* Color de fondo más neutro si deseas un cambio en todo el cuerpo */
        }
    </style>
{% endblock %}

{% block content %}
<div class="container mt-5 custom-background">
    <h1 class="text-center display-4 text-black fw-bold">Radicar PQRSF</h1>
    <p class="text-center lead mt-3 fw-bold">
        <i class="fa fa-info-circle"></i> Para mejorar nuestros servicios, registre aquí sus peticiones, quejas, reclamos o sugerencias.
    </p>

    <!-- Video tutorial -->
    <div class="row justify-content-center">
        <div class="col-12 col-md-8">
            <video controls class="w-100 mb-4">
                <source src="/media/tutorial_pqrsf.mp4" type="video/mp4">
                Su navegador no soporta videos.
            </video>
        </div>
    </div>

    <div class="container mt-5">
        <h3 class="text-center text-black fw-bold">Preguntas Frecuentes</h3>
        <div class="accordion" id="faqAccordion">
            <!-- Pregunta 1 -->
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingOne">
                    <button class="accordion-button fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                        ¿Qué es una PQRSF?
                    </button>
                </h2>
                <div id="collapseOne" class="accordion-collapse collapse" aria-labelledby="headingOne" data-bs-parent="#faqAccordion">
                    <div class="accordion-body">
                        Una PQRSF (Petición, Queja, Reclamo, Sugerencia o Felicitación) es un mecanismo utilizado para recibir, registrar y dar respuesta a inquietudes o comentarios de los usuarios.
                    </div>
                </div>
            </div>
    
            <!-- Pregunta 2 -->
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingTwo">
                    <button class="accordion-button fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                        ¿Cómo puedo adjuntar un archivo?
                    </button>
                </h2>
                <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#faqAccordion">
                    <div class="accordion-body">
                        Para adjuntar un archivo, selecciona la opción de adjuntar archivo en el formulario y elige el archivo desde tu dispositivo.
                    </div>
                </div>
            </div>
    
            <!-- Pregunta 3 -->
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingThree">
                    <button class="accordion-button fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                        ¿Cuánto tiempo se tarda en recibir respuesta?
                    </button>
                </h2>
                <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#faqAccordion">
                    <div class="accordion-body">
                        El tiempo de respuesta puede variar, pero generalmente te responderemos dentro de un plazo de 3 a 5 días hábiles.
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Formulario -->
    <h2 class="text-center mt-4 text-black fw-bold">RADICAR AQUÍ</h2>
    <div class="row justify-content-center form-container">
        <div class="col-12">
            <form id="pqrsfForm" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="mb-3">
                    <label for="nombres_apellidos" class="form-label fw-bold">Nombre completo</label>
                    <input type="text" id="nombres_apellidos" name="nombres_apellidos" class="form-control" placeholder="Ingrese su nombre" required>
                </div>
                <div class="mb-3">
                    <label for="cedula" class="form-label fw-bold">Cédula</label>
                    <input type="text" id="cedula" name="cedula" class="form-control" placeholder="Ingrese su número de cédula" required>
                </div>
                <div class="mb-3">
                    <label for="correo_electronico" class="form-label fw-bold">Correo electrónico</label>
                    <input type="email" id="correo_electronico" name="correo_electronico" class="form-control" placeholder="Correo válido" required>
                </div>

                <div class="mb-3">
                    <label for="celular" class="form-label fw-bold">Celular</label>
                    <input type="text" id="celular" name="celular" class="form-control" placeholder="Ingrese su celular" required>
                </div>
                
                <div class="mb-3">
                    <label for="tipo_solicitud" class="form-label fw-bold">Tipo de solicitud</label>
                    <select id="tipo_solicitud" name="tipo_solicitud" class="form-select">
                        <option value="peticion">Petición</option>
                        <option value="queja">Queja</option>
                        <option value="reclamo">Reclamo</option>
                        <option value="sugerencia">Sugerencia</option>
                        <option value="felicitacion">Felicitación</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label for="descripcion" class="form-label fw-bold">Descripción</label>
                    <textarea id="descripcion" name="descripcion" class="form-control" rows="4" required></textarea>
                </div>
                <div class="mb-3">
                    <label for="archivo" class="form-label fw-bold">Adjuntar archivo (opcional)</label>
                    <input type="file" id="archivo" name="archivo" class="form-control">
                </div>
                <div class="text-center">
                    <button type="submit" class="btn btn-success">Enviar solicitud</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Botón de accesibilidad -->
<button class="btn btn-secondary btn-accessibility">
    <i class="fa fa-universal-access"></i> Accesibilidad
</button>

<!-- Botón de WhatsApp -->
<a href="https://wa.me/123456789" class="btn btn-success btn-whatsapp">
    <i class="fa fa-whatsapp"></i>
</a>

<script>
    // Funcionalidad del formulario
    document.getElementById('pqrsfForm').addEventListener('submit', async (event) => {
        event.preventDefault();
        const form = event.target;
        const formData = new FormData(form);
        const response = await fetch("{% url 'guardar_pqrsf' %}", {
            method: "POST",
            body: formData,
            headers: {
                'X-CSRFToken': form.querySelector('[name=csrfmiddlewaretoken]').value
            }
        });
        const result = await response.json();
        alert(result.message);
        if (result.success) form.reset();
    });

    // Funcionalidad del botón de accesibilidad
    document.querySelector('.btn-accessibility').addEventListener('click', () => {
        document.querySelectorAll('.form-label, .list-group-item, .fw-bold').forEach(el => {
            el.classList.toggle('fs-5'); // Usar clase Bootstrap para texto más grande
        });
    });

    function toggleAnswer(id) {
        var respuesta = document.getElementById(id);
        respuesta.classList.toggle('d-none');
    }
</script>
{% endblock %}
